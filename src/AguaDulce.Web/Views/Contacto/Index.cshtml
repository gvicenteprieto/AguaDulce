@model AguaDulce.Web.Models.ContactoFormModel

@{
    ViewData["Title"] = "Contacto";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@if (TempData["Exito"] != null)
{
<div id="overlay" class="position-fixed top-0 start-0 w-100 h-100 d-flex flex-column justify-content-center align-items-center"
     style="background: #f2f2f2; color: #045c4d; z-index: 1080; ">
    <div class="text-center px-4 py-5 rounded shadow-lg" style="background-color: #ffffffdd; max-width: 600px;">
        <i class="bi bi-envelope-check-fill fs-1 mb-3 d-block" style="color: #00a38c;"></i>
        <h4 class="mb-3 fw-semibold">@TempData["Exito"]</h4>
        <small>Redireccionándote en breve...</small>
    </div>
</div>
}
<section class="fade-in mb-5">
    <div class="row row-cols-1 g-5">
        <h2 class="text-center mb-3">
            <i class="bi bi-journal-text me-2 text-secondary"></i> ¿Querés iniciar o mejorar tu proyecto?
        </h2>
        <p class="text-center mb-4">Estamos listos para acompañarte. Completá el formulario y nos pondremos en contacto a la brevedad.</p>

        @if (TempData["Exito"] != null)
            {
        <div class="alert alert-success alert-dismissible fade show text-center" role="alert" aria-live="polite">
            <i class="bi bi-check-circle-fill me-2"></i>
            @TempData["Exito"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
        </div>
            }


        <form asp-action="Enviar" method="post" class="row g-4 mx-auto" style="max-width: 700px;">
            @Html.AntiForgeryToken()

            <div class="col-md-6">
                <label asp-for="Nombre" class="form-label">
                    <i class="bi bi-person-fill me-1 mx-2"></i> Nombre
                </label>
                <input asp-for="Nombre" class="form-control" />
                <span asp-validation-for="Nombre" class="text-danger small"></span>
            </div>

            <div class="col-md-6">
                <label asp-for="Email" class="form-label">
                    <i class="bi bi-envelope-fill me-1 mx-2"></i> Correo
                </label>
                <input asp-for="Email" class="form-control" />
                <span asp-validation-for="Email" class="text-danger small"></span>
            </div>

            <div class="col-12">
                <label asp-for="Mensaje" class="form-label">
                    <i class="bi bi-chat-left-dots-fill me-1 mx-2"></i> Mensaje
                </label>
                <textarea asp-for="Mensaje" class="form-control" rows="5"></textarea>
                <span asp-validation-for="Mensaje" class="text-danger small"></span>
            </div>

            <div class="col-12 text-center">
                <button type="submit" class="btn btn-light mt-4" id="btnEnviar">
                    <span id="btnIcono"><i class="bi bi-send-fill me-1"></i></span>
                    Enviar
                </button>
            </div>

        </form>
    </div>

</section>
<section class="container my-5 text-center">
    <div class="row g-4 g-md-5 p-5 py-md-5">
        <partial name="_NavigationLinks" />
    </div>
</section>


@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")

    <script>
        setTimeout(() => {
            const alerta = document.querySelector('.alert-dismissible');
            if (alerta) alerta.classList.remove('show');
        }, 3000);

        // Spinner en botón al enviar
        document.getElementById('btnEnviar')?.addEventListener('click', () => {
            const icono = document.getElementById('btnIcono');
            if (icono) {
                icono.innerHTML = `<span class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true"></span>`;
            }
        });
    </script>
    <script>

        setTimeout(() => {
            const overlay = document.getElementById('overlay');
            if (overlay) {
                overlay.style.transition = 'opacity 1s ease';
                overlay.style.opacity = '0';
                setTimeout(() => {
                    overlay.remove();
                    window.location.href = '/Home'; // Redirecciona al formulario limpio
                });
            }
        }, 4000); // Tiempo que el overlay permanece visible

    </script>

}